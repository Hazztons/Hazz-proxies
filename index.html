<!-- Add this RIGHT AFTER your searchContainer div inside titleContainer -->
<img src="https://i.pinimg.com/736x/be/b7/7b/beb77bb02b2a8d50ed6b738452aba543.jpg" 
     style="position: absolute; right: 20px; top: 50%; transform: translateY(-50%); width: 200px; z-index: 1;">
     <!-- Add this RIGHT AFTER your searchContainer div inside titleContainer -->
<img src="https://i.pinimg.com/736x/be/b7/7b/beb77bb02b2a8d50ed6b738452aba543.jpg" 
     style="position: absolute; right: 0; top: 199; height: 50%; width: auto; max-width: 30%; object-fit: cover; z-index: 1;">











<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/jpg" href="favicon.jpg" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <title>HAZZ</title>
  <link href="https://fonts.googleapis.com/css2?family=Lexend&display=swap" rel="stylesheet" />
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%; background: black; overflow: hidden;
      font-family: 'Lexend', sans-serif; color: white;
    }
    #starsCanvas {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: black;
      z-index: 0;
    }
    .menu {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: bold;
      color: #b084f9;
      text-shadow: 0 0 10px #b084f9, 0 0 20px #b084f9;
      z-index: 10;
      display: flex;
      gap: 30px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .menu span {
      border-bottom: 2px solid #b084f9;
      padding-bottom: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .menu span:hover {
      color: #d4b8ff;
      text-shadow: 0 0 15px #d4b8ff, 0 0 30px #d4b8ff;
    }
    .menu span.active {
      color: #ffffff;
      text-shadow: 0 0 20px #b084f9, 0 0 40px #b084f9;
    }
    .titleContainer {
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 2;
      transition: opacity 0.5s ease;
    }
    .titleContainer.hidden {
      opacity: 0;
      pointer-events: none;
    }
    .title {
      font-size: 48px;
      font-weight: bold;
      color: #b084f9;
      text-shadow: 0 0 10px #b084f9, 0 0 20px #b084f9;
      margin-bottom: 10px;
    }
    .searchContainer {
      position: relative;
      display: inline-block;
    }
    .searchBar {
      background-color: #1e1e1e;
      border: 2px solid #b084f9;
      padding: 10px 40px 10px 10px;
      border-radius: 10px;
      color: white;
      width: 300px;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .searchBar:focus {
      outline: none;
      border-color: #d4b8ff;
      box-shadow: 0 0 10px #b084f9;
    }
    .searchClear {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #b084f9;
      cursor: pointer;
      font-size: 18px;
      display: none;
    }
    .imageAbove {
      width: 100px;
      margin: 0 auto 10px;
    }
    .imageAbove img {
      width: 100%;
    }
    .gamesContainer {
      position: absolute;
      top: 70px;
      left: 0;
      width: 100%;
      height: calc(100% - 70px);
      overflow-y: auto;
      display: none;
      flex-wrap: nowrap; /* Changed from wrap to nowrap */
      justify-content: flex-start; /* Changed from center to flex-start */
      align-content: flex-start;
      padding: 100px 20px 20px;
      gap: 20px;
      z-index: 1;
      overflow-x: auto; /* Added horizontal scrolling */
      white-space: nowrap; /* Prevent wrapping */
    }
    .gamesHeader {
      width: 100%;
      text-align: center;
      margin-bottom: 20px;
    }
    .categoryTabs {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    .categoryTab {
      background: #222;
      border: 2px solid #b084f9;
      color: #b084f9;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .categoryTab:hover, .categoryTab.active {
      background: #b084f9;
      color: white;
    }
    .gamesContainer {
  position: absolute;
  top: 70px;
  left: 0;
  width: 100%;
  height: calc(100% - 70px);
  overflow-y: auto;
  display: none;
  flex-direction: column;
  padding: 100px 20px 20px;
  z-index: 1;
}

#gamesGrid {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
}
    
    .gameBox:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px #b084f9;
    }
    .gameImage {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      background: #333;
    }
    .gameTitle {
      padding: 10px;
      text-align: center;
      font-size: 14px;
      flex-grow: 1;
      display: flex;
      align-items: center;
    }
    .favoriteBtn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(0,0,0,0.7);
      border: none;
      color: #b084f9;
      font-size: 18px;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .favoriteBtn:hover, .favoriteBtn.favorited {
      color: #ffff00;
      background: rgba(0,0,0,0.9);
    }
    .gameViewer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      z-index: 100;
      display: none;
    }
    .gameFrame {
      width: 100%;
      height: 100%;
      border: none;
    }
    .closeGame {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #b084f9;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 20px;
      cursor: pointer;
      z-index: 101;
      transition: all 0.3s ease;
    }
    .closeGame:hover {
      background: #d4b8ff;
      transform: scale(1.1);
    }
    .loadingSpinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #b084f9;
      font-size: 24px;
      z-index: 102;
    }
    .spinner {
      border: 4px solid #333;
      border-top: 4px solid #b084f9;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .settingsContainer, .chatContainer {
      position: absolute;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 600px;
      height: calc(100% - 100px);
      display: none;
      z-index: 2;
      background: rgba(34, 34, 34, 0.95);
      border: 2px solid #b084f9;
      border-radius: 15px;
      padding: 30px;
      overflow-y: auto;
    }
    .sectionTitle {
      color: #b084f9;
      font-size: 28px;
      text-align: center;
      margin-bottom: 30px;
      text-shadow: 0 0 10px #b084f9;
    }
    .settingItem {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
    }
    .settingLabel {
      color: #b084f9;
      font-size: 16px;
      margin-bottom: 8px;
    }
    .settingControl {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toggle {
      position: relative;
      width: 50px;
      height: 25px;
      background: #333;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .toggle.active {
      background: #b084f9;
    }
    .toggle::after {
      content: '';
      position: absolute;
      width: 21px;
      height: 21px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: all 0.3s ease;
    }
    .toggle.active::after {
      left: 27px;
    }
    .chatMessages {
      height: 300px;
      background: rgba(0,0,0,0.3);
      border: 1px solid #b084f9;
      border-radius: 8px;
      padding: 15px;
      overflow-y: auto;
      margin-bottom: 15px;
    }
    .chatInput {
      width: 100%;
      background: #1e1e1e;
      border: 2px solid #b084f9;
      color: white;
      padding: 12px;
      border-radius: 8px;
      font-size: 16px;
    }
    .chatInput:focus {
      outline: none;
      border-color: #d4b8ff;
      box-shadow: 0 0 10px #b084f9;
    }
    .noResults {
      text-align: center;
      color: #666;
      font-size: 18px;
      margin-top: 50px;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .menu {
        font-size: 18px;
        gap: 15px;
        top: 5px;
      }
      .title {
        font-size: 36px;
      }
      .searchBar {
        width: 250px;
      }
      .gamesContainer {
        padding: 80px 10px 20px;
        gap: 15px;
      }
      .gameBox {
        width: 140px;
        height: 200px;
      }
      .settingsContainer, .chatContainer {
        width: 95%;
        padding: 20px;
      }
      .categoryTabs {
        gap: 8px;
      }
      .categoryTab {
        padding: 6px 12px;
        font-size: 14px;
      }
    }
    
    @media (max-width: 480px) {
      .menu {
        font-size: 16px;
        gap: 10px;
      }
      .title {
        font-size: 28px;
      }
      .searchBar {
        width: 200px;
      }
      .gameBox {
        width: 120px;
        height: 180px;
      }
      .gameTitle {
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <canvas id="starsCanvas"></canvas>

  <div class="menu">
    <span onclick="showSection('settings')" id="settingsTab">Settings</span>
    <span onclick="showSection('home')" id="homeTab" class="active">Home</span>
    <span onclick="showSection('chat')" id="chatTab">Chat</span>
    <span onclick="showSection('games')" id="gamesTab">Games</span>
  </div>

  <div class="titleContainer" id="titleContainer">
    <div class="imageAbove"><img src="https://i.pinimg.com/736x/c2/5c/1e/c25c1e075a20aa4b40dc92d3d685c0bb.jpg" alt="logo" /></div>
    <div class="title" id="mainTitle"></div>
    <div class="searchContainer">
      <input class="searchBar" id="searchBar" placeholder="Search games or enter URL..." />
      <button class="searchClear" id="searchClear" onclick="clearSearch()">×</button>
    </div>
  </div>

  <div class="gamesContainer" id="gamesContainer">
    <div class="gamesHeader">
      <div class="categoryTabs">
        <div class="categoryTab active" onclick="filterGames('all')">All Games</div>
        <div class="categoryTab" onclick="filterGames('action')">Action</div>
        <div class="categoryTab" onclick="filterGames('sports')">Sports</div>
        <div class="categoryTab" onclick="filterGames('io')">IO Games</div>
        <div class="categoryTab" onclick="filterGames('favorites')">★ Favorites</div>
      </div>
    </div>
    <div id="gamesGrid"></div>
    <div class="noResults" id="noResults" style="display: none;">
      No games found. Try a different search term.
    </div>
  </div>

  <div class="settingsContainer" id="settingsContainer">
    <div class="sectionTitle">Settings</div>
    <div class="settingItem">
      <div class="settingLabel">Enable Sound Effects</div>
      <div class="settingControl">
        <div class="toggle active" id="soundToggle" onclick="toggleSetting('sound')"></div>
      </div>
    </div>
    <div class="settingItem">
      <div class="settingLabel">Auto-fullscreen Games</div>
      <div class="settingControl">
        <div class="toggle" id="fullscreenToggle" onclick="toggleSetting('fullscreen')"></div>
      </div>
    </div>
    <div class="settingItem">
      <div class="settingLabel">Show Game Categories</div>
      <div class="settingControl">
        <div class="toggle active" id="categoriesToggle" onclick="toggleSetting('categories')"></div>
      </div>
    </div>
    <div class="settingItem">
      <div class="settingLabel">Enable Keyboard Shortcuts</div>
      <div class="settingControl">
        <div class="toggle active" id="shortcutsToggle" onclick="toggleSetting('shortcuts')"></div>
      </div>
    </div>
  </div>

  <div class="chatContainer" id="chatContainer">
    <div class="sectionTitle">Chat Room</div>
    <div class="chatMessages" id="chatMessages">
      <div style="color: #b084f9; font-size: 14px; margin-bottom: 10px;">
        Welcome to HAZZ Chat! Share your favorite games and tips.
      </div>
    </div>
    <input class="chatInput" id="chatInput" placeholder="Type your message..." onkeypress="handleChatInput(event)" />
  </div>

  <div class="gameViewer" id="gameViewer">
    <div class="loadingSpinner" id="loadingSpinner">
      <div class="spinner"></div>
      Loading game...
    </div>
    <button class="closeGame" onclick="closeGame()">×</button>
    <iframe class="gameFrame" id="gameFrame" allowfullscreen></iframe>
  </div>

  <script>
    // Settings storage
    let settings = {
      sound: true,
      fullscreen: false,
      categories: true,
      shortcuts: true
    };

    // Favorites storage
    let favorites = JSON.parse(localStorage.getItem('hazzFavorites') || '[]');

    // Load settings from localStorage
    try {
      const savedSettings = localStorage.getItem('hazzSettings');
      if (savedSettings) {
        settings = { ...settings, ...JSON.parse(savedSettings) };
      }
    } catch (e) {
      console.log('Could not load settings');
    }

    // === Starfield animation code ===
    const canvas = document.getElementById('starsCanvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    
    function resize() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
    }
    window.addEventListener('resize', resize);
    resize();

    class Star {
      constructor(x, y, size, speedX, speedY) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.speedX = speedX;
        this.speedY = speedY;
        this.broken = false;
        this.particles = [];
      }
      update() {
        if (!this.broken) {
          this.x += this.speedX;
          this.y += this.speedY;
          if (this.x < 0) this.x = width;
          if (this.x > width) this.x = 0;
          if (this.y < 0) this.y = height;
          if (this.y > height) this.y = 0;
        } else {
          this.particles.forEach(p => p.update());
          this.particles = this.particles.filter(p => !p.done);
          if (this.particles.length === 0) return false;
        }
        return true;
      }
      draw() {
        if (!this.broken) {
          ctx.fillStyle = 'white';
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        } else {
          this.particles.forEach(p => p.draw());
        }
      }
      break() {
        if (this.broken) return;
        this.broken = true;
        const count = 8 + Math.floor(Math.random() * 5);
        for (let i = 0; i < count; i++) {
          const angle = (Math.PI * 2 / count) * i;
          const speed = Math.random() * 2 + 1;
          this.particles.push(new Particle(this.x, this.y, Math.random() * (this.size / 2), Math.cos(angle) * speed, Math.sin(angle) * speed));
        }
      }
    }

    class Particle {
      constructor(x, y, size, speedX, speedY) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.speedX = speedX;
        this.speedY = speedY;
        this.life = 60;
        this.done = false;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.speedX *= 0.95;
        this.speedY *= 0.95;
        this.life--;
        if (this.life <= 0) this.done = true;
      }
      draw() {
        ctx.fillStyle = `rgba(255,255,255,${this.life / 60})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    const stars = [];
    const STAR_COUNT = 80;
    for (let i = 0; i < STAR_COUNT; i++) {
      stars.push(new Star(Math.random() * width, Math.random() * height, 2.0, (Math.random() - 0.5) * 0.3, (Math.random() - 0.5) * 0.3));
    }
    
    function animate() {
      ctx.clearRect(0, 0, width, height);
      for (let i = stars.length - 1; i >= 0; i--) {
        const alive = stars[i].update();
        if (!alive) stars.splice(i, 1);
      }
      stars.forEach(star => star.draw());
      requestAnimationFrame(animate);
    }
    
    canvas.addEventListener('click', e => {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      for (const star of stars) {
        if (!star.broken) {
          const dx = star.x - mouseX;
          const dy = star.y - mouseY;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < 10) {
            star.break();
            break;
          }
        }
      }
    });
    animate();

    // === Section switching ===
    let currentSection = 'home';
    
    function showSection(section) {
      const titleContainer = document.getElementById('titleContainer');
      const gamesContainer = document.getElementById('gamesContainer');
      const settingsContainer = document.getElementById('settingsContainer');
      const chatContainer = document.getElementById('chatContainer');
      
      // Update active tab
      document.querySelectorAll('.menu span').forEach(tab => tab.classList.remove('active'));
      document.getElementById(section + 'Tab').classList.add('active');
      
      // Hide all sections
      titleContainer.classList.add('hidden');
      gamesContainer.style.display = 'none';
      settingsContainer.style.display = 'none';
      chatContainer.style.display = 'none';
      
      currentSection = section;
      
      // Show selected section
      if (section === 'home') {
        titleContainer.classList.remove('hidden');
      } else if (section === 'games') {
        gamesContainer.style.display = 'flex';
      } else if (section === 'settings') {
        settingsContainer.style.display = 'block';
        updateSettingsUI();
      } else if (section === 'chat') {
        chatContainer.style.display = 'block';
      }
    }

    // === Games list with categories ===
    const games = [
      { name: "Basket ball random", image: "https://imgs.crazygames.com/basket-random_16x9/20240617090207/basket-random_16x9-cover?metadata=none&quality=70&width=618", url: "https://static.playunblocked.com/2020/05/basket-random/", category: "sports" },
      { name: "Drift Boss", image: "https://imgs.crazygames.com/games/drift-boss/cover_16x9-1732741931008.png?metadata=none&quality=70&width=618", url: "https://html5.gamedistribution.com/0a8b51e5eaee42e7b4db83ca00afc92e/?gd_sdk_referrer_url=https://gamedistribution.com/games/drift-boss/", category: "action" },
      { name: "Eaglercraft", image: "https://assets.nintendo.eu/image/upload/f_auto,c_limit,w_992,q_auto:low/MNS/NOE/70010000000963/SQ_NSwitch_Minecraft", url: "https://eaglecraft.pages.dev/", category: "action" },
      { name: "1v1.LOL", image: "https://imgs.crazygames.com/games/1v1-lol/cover-1585728351086.png?metadata=none&quality=70&width=618", url: "https://1v1.lol/", category: "action" },
      { name: "slope", image: "https://forum.y8.com/uploads/default/original/2X/1/1ee17b4ce90101ffcaf17c246dc5c1adeb7b0b61.jpeg", url: "https://slope4classroom.com/", category: "action" },
      { name: "Territorial.io", image: "https://www.dexerto.com/cdn-image/wp-content/uploads/2022/05/12/territorial-io-cover.jpg?width=768&quality=60&format=auto", url: "https://territorial.io/", category: "io" },
      { name: "Paper.io 2", image: "https://play-lh.googleusercontent.com/SWTpYqsX9RN2YirCDnAjQ8qsbgn4UrHkRRGsjwuASnHMVqssIvWKzq82mP82y_ffBSE=w240-h480-rw", url: "https://games.voodoo.io/paperio2", category: "io" },
      { name: "10 minutes till dawn", image: "https://imgs.crazygames.com/games/10-minutes-till-dawn/cover-1652811077990.png?metadata=none&quality=70&width=618", url: "https://nexusapp.neocities.org/moderngame/projects/10-minutes-till-dawn/", category: "action" },
      { name: "Basketball Stars", image: "https://imgs.crazygames.com/games/basketball-stars-2019/cover-1583231506155.png?metadata=none&quality=70&width=618", url: "https://igre.games/basketball-stars/fullscreen/", category: "sports" },
      { name: "Deadshot.io", image: "https://imgs.crazygames.com/games/deadshot-io/cover_16x9-1694770506842.png?metadata=none&quality=70&width=618", url: "https://deadshot.io/", category: "io" },
      { name: "Boxing random", image: "https://play-lh.googleusercontent.com/ZuMoNX6xiIBRwdtSLi_JLyqKBT5JK-68TwhG56WIPF5FStzDtOrEJUSiSGTna0Ul_UYE", url: "https://html5.gamedistribution.com/2021/04/01/boxing-random/163350/", category: "sports" },
      { name: "soccer random", image: "https://play-lh.googleusercontent.com/8esBqZBSLjcdjFCz5tbpl2krim0pIBrELbhXFMvQVWqAYqCyTGJuGMBBC_nGkfH-qTg", url: "https://html5.gamedistribution.com/2021/04/01/soccer-random/163355/", category: "sports" }
    ];

    let filteredGames = [...games];
    let currentFilter = 'all';
    
    function loadGames() {
      const gamesGrid = document.getElementById('gamesGrid');
      const noResults = document.getElementById('noResults');
      
      gamesGrid.innerHTML = '';
      
      if (filteredGames.length === 0) {
        noResults.style.display = 'block';
        return;
      }
      
      noResults.style.display = 'none';
      
      for (const game of filteredGames) {
        const box = document.createElement('div');
        box.className = 'gameBox';
        const isFavorited = favorites.includes(game.name);
        
        box.innerHTML = `
          <button class="favoriteBtn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite('${game.name}', event)">
            ${isFavorited ? '★' : '☆'}
          </button>
          <img src="${game.image}" alt="${game.name}" class="gameImage" onerror="this.src='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"120\" viewBox=\"0 0 160 120\"><rect width=\"160\" height=\"120\" fill=\"%23333\"/><text x=\"80\" y=\"65\" text-anchor=\"middle\" fill=\"%23666\" font-size=\"14\">No Image</text></svg>'" />
          <div class="gameTitle">${game.name}</div>
        `;
        
        box.onclick = (e) => {
          if (!e.target.classList.contains('favoriteBtn')) {
            openGame(game.url, game.name);
          }
        };
        
        gamesGrid.appendChild(box);
      }
    }

    function filterGames(category) {
      // Update active category tab
      document.querySelectorAll('.categoryTab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
      
      currentFilter = category;
      
      if (category === 'all') {
        filteredGames = [...games];
      } else if (category === 'favorites') {
        filteredGames = games.filter(game => favorites.includes(game.name));
      } else {
        filteredGames = games.filter(game => game.category === category);
      }
      
      // Apply search filter if active
      const searchTerm = document.getElementById('searchBar').value.toLowerCase();
      if (searchTerm) {
        filteredGames = filteredGames.filter(game => 
          game.name.toLowerCase().includes(searchTerm)
        );
      }
      
      loadGames();
    }

    function toggleFavorite(gameName, event) {
      event.stopPropagation();
      
      const index = favorites.indexOf(gameName);
      if (index > -1) {
        favorites.splice(index, 1);
      } else {
        favorites.push(gameName);
      }
      
      // Save to localStorage
      try {
        localStorage.setItem('hazzFavorites', JSON.stringify(favorites));
      } catch (e) {
        console.log('Could not save favorites');
      }
      
      // Refresh games display
      filterGames(currentFilter);
    }

    // === Search functionality ===
    const searchBar = document.getElementById('searchBar');
    const searchClear = document.getElementById('searchClear');
    
    searchBar.addEventListener('input', function() {
      const searchTerm = this.value.toLowerCase().trim();
      const clearBtn = document.getElementById('searchClear');
      
      if (searchTerm) {
        clearBtn.style.display = 'block';
        
        // Check if it's a URL
        if (searchTerm.startsWith('http://') || searchTerm.startsWith('https://')) {
          openGame(searchTerm, 'Custom URL');
          return;
        }
        
        // Filter games based on search
        if (currentSection === 'games') {
          let baseGames = games;
          if (currentFilter !== 'all') {
            if (currentFilter === 'favorites') {
              baseGames = games.filter(game => favorites.includes(game.name));
            } else {
              baseGames = games.filter(game => game.category === currentFilter);
            }
          }
          
          filteredGames = baseGames.filter(game => 
            game.name.toLowerCase().includes(searchTerm)
          );
          loadGames();
        }
      } else {
        clearBtn.style.display = 'none';
        if (currentSection === 'games') {
          filterGames(currentFilter);
        }
      }
    });
    
    function clearSearch() {
      searchBar.value = '';
      searchClear.style.display = 'none';
      if (currentSection === 'games') {
        filterGames(currentFilter);
      }
    }

    // === Game loading and error handling ===
    function openGame(url, name) {
      try {
        const viewer = document.getElementById('gameViewer');
        const iframe = document.getElementById('gameFrame');
        const loading = document.getElementById('loadingSpinner');
        
        // Show loading state
        viewer.style.display = 'block';
        loading.style.display = 'block';
        iframe.style.display = 'none';
        
        // Set iframe source
        iframe.src = url;
        
        // Handle iframe load events
        iframe.onload = function() {
          loading.style.display = 'none';
          iframe.style.display = 'block';
          
          // Auto-fullscreen if enabled
          if (settings.fullscreen && iframe.requestFullscreen) {
            iframe.requestFullscreen();
          }
        };
        
        iframe.onerror = function() {
          loading.innerHTML = `
            <div style="text-align: center;">
              <div style="color: #ff6b6b; font-size: 24px; margin-bottom: 10px;">⚠️</div>
              <div>Failed to load game</div>
              <div style="font-size: 14px; margin-top: 10px; color: #999;">
                ${name || 'Game'} could not be loaded. Try again later.
              </div>
            </div>
          `;
        };
        
        // Timeout fallback
        setTimeout(() => {
          if (loading.style.display !== 'none') {
            iframe.onload();
          }
        }, 10000);
        
      } catch (error) {
        console.error('Error opening game:', error);
        alert('Failed to open game. Please try again.');
      }
    }
    
    function closeGame() {
      const viewer = document.getElementById('gameViewer');
      const iframe = document.getElementById('gameFrame');
      const loading = document.getElementById('loadingSpinner');
      
      iframe.src = '';
      viewer.style.display = 'none';
      loading.style.display = 'block';
      iframe.style.display = 'none';
      
      // Exit fullscreen if active
      if (document.fullscreenElement) {
        document.exitFullscreen();
      }
    }

    // === Settings functionality ===
    function toggleSetting(setting) {
      settings[setting] = !settings[setting];
      
      try {
        localStorage.setItem('hazzSettings', JSON.stringify(settings));
      } catch (e) {
        console.log('Could not save settings');
      }
      
      updateSettingsUI();
    }
    
    function updateSettingsUI() {
      document.getElementById('soundToggle').classList.toggle('active', settings.sound);
      document.getElementById('fullscreenToggle').classList.toggle('active', settings.fullscreen);
      document.getElementById('categoriesToggle').classList.toggle('active', settings.categories);
      document.getElementById('shortcutsToggle').classList.toggle('active', settings.shortcuts);
      
      // Apply settings
      const categoryTabs = document.querySelector('.categoryTabs');
      if (categoryTabs) {
        categoryTabs.style.display = settings.categories ? 'flex' : 'none';
      }
    }

    // === Chat functionality ===
    let chatMessages = [];
    
    function handleChatInput(event) {
      if (event.key === 'Enter') {
        const input = document.getElementById('chatInput');
        const message = input.value.trim();
        
        if (message) {
          addChatMessage('You', message);
          input.value = '';
          
          // Simple bot responses
          setTimeout(() => {
            const responses = [
              "Kolade is so cool",
              "Guess you havent heard of a electric chainsaw.",
              "Tonights the night.",
              "Haroon is brian moser",
              "ayman is so cool",
              "Justin is a n****",
              "George is so sexy",
              "George likes monika",
              "Aryan is a gay little bastard paki"
            ];
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            addChatMessage('HAZZ Bot', randomResponse);
          }, 1000);
        }
      }
    }
    
    function addChatMessage(sender, message) {
      const chatMessagesDiv = document.getElementById('chatMessages');
      const messageEl = document.createElement('div');
      messageEl.style.marginBottom = '10px';
      messageEl.innerHTML = `
        <strong style="color: ${sender === 'You' ? '#b084f9' : '#4CAF50'};">${sender}:</strong>
        <span style="color: white;">${message}</span>
        <div style="font-size: 12px; color: #666; margin-top: 2px;">
          ${new Date().toLocaleTimeString()}
        </div>
      `;
      chatMessagesDiv.appendChild(messageEl);
      chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
    }

    // === Keyboard shortcuts ===
    document.addEventListener('keydown', function(event) {
      if (!settings.shortcuts) return;
      
      // ESC to close game
      if (event.key === 'Escape') {
        const gameViewer = document.getElementById('gameViewer');
        if (gameViewer.style.display === 'block') {
          closeGame();
          event.preventDefault();
        }
      }
      
      // Number keys for quick navigation
      if (event.ctrlKey || event.metaKey) {
        switch(event.key) {
          case '1':
            showSection('home');
            event.preventDefault();
            break;
          case '2':
            showSection('games');
            event.preventDefault();
            break;
          case '3':
            showSection('chat');
            event.preventDefault();
            break;
          case '4':
            showSection('settings');
            event.preventDefault();
            break;
          case 'f':
            document.getElementById('searchBar').focus();
            event.preventDefault();
            break;
        }
      }
    });

    // === Typing animation for the title ===
    const titleText = '𝑯𝑨𝒁𝒁𝑺 𝑷𝑹𝑶𝑿𝒀';
    const mainTitle = document.getElementById('mainTitle');
    let idx = 0;

    function typeTitle() {
      if (idx < titleText.length) {
        mainTitle.textContent += titleText.charAt(idx);
        idx++;
        setTimeout(typeTitle, 150);
      }
    }

    // === Initialization ===
    window.onload = () => {
      mainTitle.textContent = '';
      typeTitle();
      loadGames();
      updateSettingsUI();
      
      // Add welcome message to chat
      setTimeout(() => {
        addChatMessage('This is', 'Hazz bot hes not very freindly..');
      }, 2000);
    };

    // Initialize filtered games
    filterGames('all');
  </script>
</body>
</html>